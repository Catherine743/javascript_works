<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Page</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>

<body class="h-[1000px]">
    <div class="flex justify-between px-5">
        <h2 class="text-3xl flex justify-center items-center text-blue-900" id="head">Welcome User</h2>
        <h1 class="text-4xl flex justify-center items-center h-[100px] text-green-700 font-bold">Smart Wallet</h1>
        <div class="flex justify-center items-center  w-[100px]">
            <button class="border text-red-700 rounded-md w-full h-[40px] hover:bg-red-700 hover:text-white"
                onclick="logout()">Log
                out</button>
        </div>
    </div>
    <div class="flex justify-center">
        <div class="w-3/4 h-[2px] bg-blue-700 my-5"></div>
    </div>
    <div class="w-full flex">
        <div class="w-1/2 space-y-5">
            <div class="w-full flex justify-center">
                <div
                    class="space-y-3 bg-orange-300 w-1/3 text-center h-[150px] flex justify-center items-center rounded-lg">
                    <div class="space-y-5">
                        <h3 class="text-3xl">Total Balance</h3>
                        <h3 class="text-3xl" id="balance">Rs 0 /-</h3>
                    </div>
                </div>
            </div>
            <h3 class="flex justify-center text-3xl text-green-700 italic">Add Income</h3>
            <div class="flex justify-center">
                <div class="w-3/4 h-[1.5px] bg-green-700 my-5"></div>
            </div>
            <div class="mx-auto space-y-5 w-3/4">
                <div>
                    <input class="w-full p-2 rounded-md border-2 border-sky-500 placeholder:font-bold" type="text"
                        placeholder="Enter Income Type" id="incomeType">
                </div>
                <div>
                    <input class="w-full p-2 rounded-md border-2 border-sky-500 placeholder:font-bold" type="number"
                        placeholder="Enter Amount" id="incomeAmt">
                </div>
                <button class="w-full border h-[40px] rounded-lg bg-green-700 text-white hover:bg-green-900"
                    onclick="addIncome()">Add Income</button>
            </div>
        </div>
        <div class="w-1/2 space-y-5">
            <div class="w-full flex justify-center">
                <div
                    class="space-y-3 bg-green-300 w-1/3 text-center h-[150px] flex justify-center items-center rounded-lg">
                    <div class="space-y-5">
                        <h3 class="text-3xl">Total Expenses</h3>
                        <h3 class="text-3xl" id="expense">Rs 0 /-</h3>
                    </div>
                </div>
            </div>
            <h3 class="flex justify-center text-3xl text-green-700 italic">Add Expense</h3>
            <div class="flex justify-center">
                <div class="w-3/4 h-[1.5px] bg-green-700 my-5"></div>
            </div>
            <div class="mx-auto space-y-5 w-3/4">
                <div>
                    <input class="w-full p-2 rounded-md border-2 border-sky-500 placeholder:font-bold" type="text"
                        placeholder="Enter Expense Type" id="expenseType">
                </div>
                <div>
                    <input class="w-full p-2 rounded-md border-2 border-sky-500 placeholder:font-bold" type="number"
                        placeholder="Enter Amount" id="expenseAmt">
                </div>
                <button class="w-full border h-[40px] rounded-lg bg-red-700 text-white hover:bg-red-900"
                    onclick="addExpense()">Add Expense</button>
            </div>
        </div>
    </div>
    <div class="flex justify-center my-10">
        <button class="bg-yellow-500 text-white rounded-md text-center w-[100px] h-[40px] hover:bg-yellow-600"
            onclick="clearBtn()">Clear All</button>
    </div>
    <h2 class="text-3xl text-center font-bold text-blue-700">Transaction History</h2>
    <div class="flex justify-center">
        <div class="w-3/4 h-[2px] bg-blue-700 my-5"></div>
    </div>
    <div class="flex ">
        <div class="w-1/2 flex justify-center">
            <div class="w-3/4 space-y-5">
                <h3 class="text-2xl text-blue-700 text-center font-semibold">Income</h3>
                <table class="w-full h-[30px] text-right">
                    <thead class="bg-orange-200 border-b-5 border-red-400">
                        <tr class="text-center">
                            <th>Type</th>
                            <th>Amount</th>
                            <th>Balance</th>
                            <th>Date & Time</th>
                        </tr>
                    </thead>
                    <tbody id="incomeTable"></tbody>
                </table>
            </div>
        </div>
        <div class="w-1/2 flex justify-center">
            <div class="w-3/4 space-y-5">
                <h3 class="text-2xl text-blue-700 text-center font-semibold">Expense</h3>
                <table class="w-full">
                    <thead class="bg-orange-200 border-b-5 border-red-400">
                        <tr class="text-center">
                            <th>Type</th>
                            <th>Amount</th>
                            <th>Balance</th>
                            <th>Date & Time</th>
                        </tr>
                    </thead>
                    <tbody id="expenseTable"></tbody>
                </table>
            </div>
        </div>
</body>
<script>
    username = localStorage.getItem('USER_NAME')
    head.innerHTML = `Welcome ${username}`
    function getCurrentDateTime() {
        now = new Date();
        day = now.getDate();
        month = now.getMonth() + 1; // months start at 0
        year = now.getFullYear();
        hours = now.getHours();
        minutes = now.getMinutes().toString().padStart(2, '0');
        seconds = now.getSeconds().toString().padStart(2, '0');
        return `${day}/${month}/${year} ${hours}:${minutes}:${seconds}`;
    }
    incomeList = JSON.parse(localStorage.getItem("INCOME_LIST")) || [];
    expenseList = JSON.parse(localStorage.getItem("EXPENSE_LIST")) || [];
    totalExpense = Number(localStorage.getItem("EXP_AMOUNT")) ;
    curBal = JSON.parse(localStorage.getItem('BAL_AMOUNT')) || 0;
    balance.innerHTML = `Rs ${curBal} /-`;
    expense.innerHTML = `Rs ${totalExpense} /-`;
    function renderIncomeTable() {
        incomeTable.innerHTML = "";
        incomeList.forEach(item => {
        incomeTable.innerHTML += `
        <tr class = "text-center border-b-2 border-green-700 h-[30px]">
           <td>${item.type}</td>
           <td>+${item.amount}</td>
           <td>${item.balance}</td>
           <td>${item.time}</td>
        </tr>
        `
        });
    }
    function renderExpenseTable() {
        expenseTable.innerHTML = "";
        expenseList.forEach(item => {
        expenseTable.innerHTML += `
        <tr class = "text-center border-b-2 border-green-700 h-[30px]">
           <td>${item.type}</td>
           <td>-${item.amount}</td>
           <td>${item.balance}</td>
           <td>${item.time}</td>
        </tr>
        `
        });
    }
    function addIncome() {
        if (incomeAmt.value > 0 && incomeType.value) {
            amountNum = Number(incomeAmt.value);
            alert(`Income amount added successfully: ${amountNum}`);
            curBal += amountNum;
            localStorage.setItem('BAL_AMOUNT', curBal);
            dateTime = getCurrentDateTime()
            incomeObj = {
                type: incomeType.value,
                amount: amountNum,
                balance: curBal,
                time: dateTime
            };
            incomeList.push(incomeObj);
            localStorage.setItem("INCOME_LIST", JSON.stringify(incomeList));
            balance.innerHTML = `
            Rs ${curBal} /-
            `
            incomeAmt.value = '';
            incomeType.value = '';
            renderIncomeTable();
        }
        else if (!incomeType.value || !incomeAmt.value) {
            alert("Please fill all the fields")
        }
    }
    function addExpense() {
        if (expenseAmt.value > 0 && expenseType.value) {
            amountNum = Number(expenseAmt.value);
            if (curBal >= amountNum) {
                curBal -= amountNum;
                totalExpense += amountNum;
                localStorage.setItem("EXP_AMOUNT", totalExpense);
                localStorage.setItem('BAL_AMOUNT', curBal);
                dateTime = getCurrentDateTime()
                expenseObj = {
                    type: expenseType.value,
                    amount: amountNum,
                    balance: curBal,
                    time: dateTime
                };
                expenseList.push(expenseObj);
                localStorage.setItem("EXPENSE_LIST", JSON.stringify(expenseList));
                alert(`Expense amount added successfully: ${amountNum}`);
                expense.innerHTML = `
                Rs ${totalExpense} /-
                `
                balance.innerHTML = `
                Rs ${curBal} /-
                `
                expenseAmt.value = '';
                expenseType.value = '';
                renderExpenseTable();
            }
            else {
                alert("Insufficient balance")
            }
        }
        else if (!expenseAmt.value || !expenseType.value) {
            alert("Please fill all the fields")
        }
    }
    function clearBtn() {
        if (confirm("Are you sure you want clear all data ?")) {
            localStorage.clear();
            alert("Cleared all data successfully")
            location.reload();
        }
    }
    function logout() {
        window.location = './index.html'
    }
    renderIncomeTable();
    renderExpenseTable();
</script>

</html>